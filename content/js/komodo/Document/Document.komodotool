{"keyboard_shortcut":"","name":"Document","language":"JavaScript","trigger_enabled":false,"value":["if( typeof ko.extensions.TemplateExtension === 'undefined'  )\r","\tko.extensions.TemplateExtension = {};\r","\r","/** Get extension`s window.document\r"," * Allow access to extenion`s window from scripts\r"," * @example for independent testing via uerscript\r"," * \r"," */\r","ko.extensions.TemplateExtension.Document = {};\r","(function()\r","{\r","\tfunction Document()\r","\t{\r","\t\tvar host_name\t= 'TemplateExtension';\r","\t\t\r","\t\t/** Get window.document of extension\r","\t\t * \r","\t\t * @example  get('preferences') return document of preferences.xul\r","\t\t * \r","\t\t * @param\tstring\tfilename\tBasename of *.xul file\r","\t\t * @return\tobject\tdocument\r","\t\t */\r","\t\tthis.get = function(filename)\r","\t\t{\r","\t\t\tvar windows\t= require(\"ko/windows\").getAll();\r","\t\t\tvar rx_host_name\t= new RegExp( host_name, 'gi');\r","\t\t\tvar rx_filename\t= new RegExp( filename + '.xul$', 'gi');\t\t\t\r","\t\t\t\r","\t\t\tfor(let w=0; w<windows.length;w++)\r","\t\t\t{\r","\t\t\t\tvar window_frame\t= windows[w].frameElement;\r","\t\t\t\tvar window_location\t= window_frame ? window_frame.contentWindow.document.location : null;\r","\t\t\t\t\r","\t\t\t\tif( window_frame && window_location.host.match(rx_host_name) && window_location.pathname.match( rx_filename ) )\r","\t\t\t\t\treturn  windows[w].frameElement.contentWindow.document;\t\t\r","\t\t\t}\r","\t\t};\r","\t\t/** test\r","\t\t */\r","\t\tthis.test = function()\r","\t\t{\r","\t\t\talert( 'TemplateExtension.Document.test()' ); \r","\t\t}; \r","\t}\r","\treturn Document;\r","\r","})().apply(ko.extensions.TemplateExtension.Document);"],"version":"1.0.12","rank":100,"async":false,"type":"macro","trigger":"trigger_postopen"}