{"keyboard_shortcut":"","name":"UI","language":"JavaScript","trigger_enabled":false,"value":["/** UI\r"," * \r","*/\r","ko.extensions.TemplateExtension.Komodo.UI = (function()\r","{\r","\t\t\r","\tfunction UI(_document=null)\r","\t{\r","\t\t//var Logger\t= ko.extensions.Logger_v3 ? new ko.extensions.Logger_v3(this).clear(false).off(false) : require('ko/console');\r","\t\tvar self\t= this;\r","\t\tvar $\t= require('ko/dom');\r","\t\tvar document\t= document;\r","\t\tvar node\t= null;\r","\t\tvar parent\t= $(document);\t\t\t\t\r","\t\tvar values\t= {};\r","\r","\t\t/*---------------------------------------\r","\t\t\tSETUP\r","\t\t-----------------------------------------\r","\t\t*/\r","\t\t/** Set document\r","\t\t *\r","\t\t * @param\tstring\tdocument\r","\t\t * @return\tself \r","\t\t */\r","\t\tthis.document = function(_document)\r","\t\t{\r","\t\t\tdocument = _document;\r","\t\t\treturn this;\r","\t\t};\r","\r","\t\t/** Set node element \r","\t\t *\r","\t\t * @param\tstring\tparent_selector\r","\t\t * @return\tself \r","\t\t */\r","\t\tthis.node = function(selector)\r","\t\t{\r","\t\t\tif( selector )\r","\t\t\t\tnode = $(selector, document);\r","\t\t\t\r","\t\t\treturn this;\r","\t\t};\r","\t\t\r","\t\t/** Query selector in document\r","\t\t * \r","\t\t * @param\tstring\tselector\tSelector of node\r","\t\t * @param\tstring\tselector\tSelector of parent, if null, then current document is used\r","\t\t * \r","\t\t * @return\ttype\t[QueryObject](https://docs.activestate.com/komodo/11/sdk/api/module-ko_dom-QueryObject.html)\r","\t\t */\r","\t\tthis.$ = function(selector, parent=null)\r","\t\t{\r","\t\t\tparent = parent ? $(parent, document).element() : document;\r","\t\t\t\r","\t\t\t//return $(selector, parent ? parent : document);\r","\t\t\t//return $(selector, document);\r","\t\t\treturn $(selector, parent);\t\t\t\t\r","\t\t};\r","\t\t/** Create new node\r","\t\t * @param\tstring\ttype\tType of node\r","\t\t * @param\tobject|string\tattributes\tObject of attributes for element, STRING is treated as label\r","\t\t * @return self\r","\t\t */\r","\t\tthis.create = function(type, attributes)\r","\t\t{\r","\t\t\treturn new ko.extensions.TemplateExtension.Komodo.Node()\r","\t\t\t\t\t\t\t\t\t\t .type(type)\t\t\t\t\t\t\t\t\t\t\t\t\t \r","\t\t\t\t\t\t\t\t\t\t .attributes(attributes)\r","\t\t\t\t\t\t\t\t\t\t .get();\r","\t\t}; \r","\t\t/** Get values of parent node controls\r","\t\t * @param\tstring\tparent_selector\r","\t\t * @return\t{id: value}\tObject of node ids and values\r","\t\t */\r","\t\tthis.values = function(selector=null)\r","\t\t{\r","\t\t\tthis.node(selector);\r","\t\t\t//alert('UI.values()');\r","\t\t\t//console.log(  document );\r","\t\t\tvalues\t= {};\r","\r","\t\t\tsetValuesFormChildNodes( $(parent_selector, document).children() );\r","\t\t\t\r","\t\t\treturn values;\r","\t\t};\r","\r","\t\t/** Append new nodes to node\r","\t\t *  If children are defined, then parent node became this.node\r","\t\t *\r","\t\t * @example \r","\t\t *\t\t.append('checkbox', 'Checkbox 1')\t// single node, attribute is label\r","\t\t *\t\t.append('checkbox', {label: 'Checkbox 1'})\t// single node with attributes\t\t \r","\t\t *\t\t.append('checkbox', ['Checkbox 1', 'Checkbox 2'])\t// multiple nodes\r","\t\t *\t\t.append('checkbox', [{label: 'Checkbox 1'}, {label: 'Checkbox 2'}])\t// multiple nodes with attributes\r","\t\t *\r","\t\t *\t\t.append('groupbox')\t// append node without attributes\r","\t\t *\t\t.append('groupbox', {id: 'gp_id'})\t// parent node with attributes\r","\t\t *\t\t.append('groupbox', null, ['checkbox', ['Checkbox 1', 'Checkbox 2']] )\t// parent node with children\r","\t\t *\t\t.append('groupbox', {id: 'gp_id'}, ['checkbox', ['Checkbox 1', 'Checkbox 2']] )\t// parent node with attributes and children\r","\t\t *\r","\t\t * @param\tstring\ttype\tType of node to append\r","\t\t * @param\tnull|string|object|[object] \t[attributes]\tAttributes for controls, define array of strings or array of objects for adding multiple nodes* \r","\t\t * @param\t[type, attributes]\tchildren\tArray of these parameters for repeating append() function\r","\t\t *\r","\t\t * @return\tself \r","\t\t */\r","\t\tthis.append = function(type, attributes=null, children=null)\r","\t\t{\r","\t\t\tvar child_node\t= null;\r","\t\t\t/** Sanitize attributes\r","\t\t\t */\r","\t\t\tvar sanitizeAttributes = (function()\r","\t\t\t{\r","\t\t\t\tif( ! attributes )\r","\t\t\t\t\tattributes = {};\r","\t\t\t\t\r","\t\t\t\tif( ! Array.isArray(attributes) )\r","\t\t\t\t\tattributes = [attributes];\t\t\t\t\r","\t\t\t})();\r","\t\t\t/** Add controls to parent element\r","\t\t\t */\r","\t\t\tvar appendChild = function(type, attributes)\r","\t\t\t{\t\r","\t\t\t\tchild_node\t= self.create(type, attributes);\r","\r","\t\t\t\tnode.append( child_node );\r","\t\t\t};\r","\t\t\t\r","\t\t\tfor(let a=0; a<attributes.length;a++)\r","\t\t\t\tappendChild(type, typeof attributes[a] !== 'undefined' ? attributes[a] : null );\r","\t\t\t\r","\t\t\tif( children )\r","\t\t\t\tthis.node(child_node).append(children[0], children[1], children[2]);\r","\t\t\t\r","\t\t\treturn this;\r","\t\t};\r","\t\t\r","\t\t/** Remove child element\r","\t\t * @param\tstring\tselector\tSelector of node\r","\t\t * @return\tself\r","\t\t */\r","\t\tthis.empty = function(selector=null)\r","\t\t{\r","\t\t\t//console.log( 'UI.empty()' );\r","\t\t\tthis.node(selector);\r","\r","\t\t\tnode.empty();\r","\t\t\t\r","\t\t\treturn this;\r","\t\t};\r","\t\t\r","\t\t/** Vreate prefset dom\r","\t\t *\r","\t\t * @param\tstring\tprefset_id\tId of dom container where all containers are inserted\r","\t\t * @param\tobject\tperfset_template\tRepresentation of container xul structure\r","\t\t * @param\tobject\tperfset_values\tData for pref set`s controls\r","\t\t *\r","\t\t * @example\r","\t\t *\t\tperfset_template = {\r","\t\t *\t\t\tpref_set_test:{ groupbox: ['checkbox', 'checkbox'] }\r","\t\t * \t\t}\r","\t\t * \r","\t\t * \t\tperfset_values = {\r","\t\t *\t\t\t'conteiner-A':{\r","\t\t * \t\t\t\t'Control 1': true,\r","\t\t * \t\t\t\t'Control 2': false,\r","\t\t * \t\t\t}\r","\t\t * \t\t}\r","\t\t * \r","\t\t */\r","\t\tthis.createPrefSet = function(prefset_id, perfset_template, perfset_values)\r","\t\t{\r","\t\t\tvar container_type = Object.keys(perfset_template).pop();\r","\t\t\tvar control_types\t= perfset_template[container_type];\r","\t\t\tvar prefset_node\t= this.node('#'+prefset_id);\r","\t\t\tvar prefset_menu\t= this.$('menupopup', '#'+prefset_id);\r","\r","\t\t\t//console.log('UI.createPrefSet: ' +prefset_id);\r","\t\t\t//console.log( perfset_template );\r","\t\t\t//console.log( perfset_values );\r","\t\t\tconsole.log( 'prefset_menu' );\r","\t\t\tconsole.log( prefset_menu );\t\t\t\r","\t\t\t\r","\t\t\t/** Create perfset_template\r","\t\t\t *\r","\t\t\t * @param\tobject\tcontrols_data\tContainer-id: {control id-label: value}\r","\t\t\t */\r","\t\t\tvar createContainer = function(container_id, controls_data)\r","\t\t\t{\r","\t\t\t\t//console.log('UI.createContainer: ' +container_id);\r","\t\t\t\t//console.log( 'menuitem' );\r","\t\t\t\t//console.log( this.create('menuitem', container_id ) );\t\t\t\t\r","\t\t\t\t\r","\t\t\t\tprefset_menu.append( self.create('menuitem', container_id ) );\r","\t\t\t\t\r","\t\t\t\tvar controls_labels\t= Object.keys(controls_data);\r","\t\t\t\tvar container_node\t= prefset_node.append(container_type);\r","\t\t\t\t\r","\t\t\t\t\r","\t\t\t\tfor(let c=0; c<controls_labels.length;c++)\r","\t\t\t\t\tcontainer_node.append(control_types[c], {'label': controls_labels[c], 'checked':controls_data[controls_labels[c]] });\r","\r","\t\t\t};\r","\t\t\t\r","\t\t\t\r","\t\t\t\r","\t\t\tvar containers_ids\t= Object.keys(perfset_values);\t\t\r","\t\t\t//console.log( containers_ids );\r","\t\t\tfor(let i=0; i<containers_ids.length;i++)\r","\t\t\t\tcreateContainer( containers_ids[i], perfset_values[containers_ids[i]] );\r","\t\t\t\t\r","\t\t\t\r","\t\t};\r","\t\r","\t\t/*---------------------------------------\r","\t\t\tPRIVATE\r","\t\t-----------------------------------------\r","\t\t*/\r","\r","\r","\t\t/** Get values form child nodes\r","\t\t * @param\tarray\tchild_nodes\tElement list of child nodes\r","\t\t */\r","\t\tvar setValuesFormChildNodes = function(child_nodes)\r","\t\t{\r","\t\t\t//console.log( child_nodes );\r","\t\t\t//Logger.info(child_nodes, 'UI: '+'child_nodes'); \r","\t\t\t\r","\t\t\tchild_nodes.each(function()\r","\t\t\t{\r","\t\t\t\tif( ! Object.keys(this.childNodes).length ){\r","\t\t\t\t\tif( this.id )\r","\t\t\t\t\t\tvalues[this.id] = this.nodeName == 'checkbox' ? this.checked : this.value;\t\t\t\t\t\r","\t\t\t\t}else\r","\t\t\t\t\tsetValuesFormChildNodes( $(this.childNodes) );\r","\t\t\t});\r","\t\t}; \r","\t\t/** Test\r","\t\t */\r","\t\tthis.test = function()\r","\t\t{\r","\t\t\talert('UI.test()');\r","\t\t};\r","\t\t\r","\t}\r","\treturn UI;\r","\r","})();"],"version":"1.0.12","rank":100,"async":false,"type":"macro","trigger":"trigger_postopen"}